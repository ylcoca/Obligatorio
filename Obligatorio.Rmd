---
title: "Obligatorio"
output: html_document
---

## Preparation

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(class)
library(e1071) #libreria de naive bayes

source('utils.R')
set.seed(117)
raw_data <- read.csv('dataset.csv')
```

##Data Cleansing
```{r }
raw_data = raw_data[complete.cases(raw_data), ]


```

##Only Numeric Values
```{r }
nums <- unlist(lapply(raw_data,is.numeric))
raw_data2 <- raw_data[,nums]

raw_data2$Churn <- raw_data$Churn


# Particion train - test

h.part <- partition_train_test(raw_data2, ntrain = 28087)
h.train <- h.part$train
h.test <- h.part$test


```

## Naive Bayes
```{r }

h.fit <- naiveBayes(as.factor(train$Churn) ~ ., data = train)
test$yhat <- predict(h.fit, newdata = test, type = 'class') 
error <- fn_err_cla(test$yhat,test$Churn)


h.k_folds <- 5
h.cv_part <- partition_cv(h.train, k_folds = h.k_folds)
h.cv_train <- h.cv_part$train
h.cv_test <- h.cv_part$test


```

#KNN
#Logistic Regression 
#Random Forest
